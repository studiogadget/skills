# レビューチェックリスト

レビュー時にこのリストを使って、リーダブルコードの観点をチェックする。

## 全体

- [ ] 初見の同僚が短時間で説明できるか？
- [ ] そのコードは本当に必要か？ライブラリで置き換えられないか？

## 1. 命名（Naming）

- [ ] 名前だけで意味・単位・境界条件が伝わるか？
  - 単位: `timeout_ms`, `age_years`, `size_bytes`
  - 境界: `min_`, `max_`, `get_adult_users` (>= 20)
  - 意図: `fetch_user_profile`, `validate_email_format`
- [ ] ブール値は肯定形か？（`is_enabled` not `disable_flag`）
- [ ] 短すぎる名前（`v`, `t`, `data`）がないか？
- [ ] 誤解を招く名前（`filter_`, `get_`, `process_`）がないか？

## 2. 制御フロー（Control Flow）

- [ ] 失敗条件を先に処理して早期return しているか？
- [ ] ネストが深すぎないか？（3段以上は要分割）
- [ ] 条件分岐が複雑すぎないか？（説明変数で分割可能か？）
- [ ] ループより内包表記が使えないか？

## 3. 式と変数（Expressions and Variables）

- [ ] 複雑な式を説明変数に分割しているか？
  - `is_active_user = not user.is_deleted`
  - `can_access = user.role == "admin" or ...`
- [ ] 変数のスコープは必要最小限か？
- [ ] 再代入を避けられないか？（不変化）
- [ ] マジックナンバーに名前を付けているか？

## 4. 関数（Functions）

- [ ] 1関数1責務になっているか？
- [ ] 関数が長すぎないか？（20行以内推奨）
- [ ] 関数名が意図を示しているか？
- [ ] 引数が多すぎないか？（5個以上は要検討）

## 5. コメント（Comments）

- [ ] 「なぜ」を説明しているか？（「何」は避ける）
- [ ] 業務背景・判断理由を示しているか？
- [ ] 注意事項・罠（gotcha）を明記しているか？
- [ ] コードと矛盾していないか？
- [ ] 古い情報・リンク切れがないか？

## 6. 構造化（Structure）

- [ ] 段落構造が一貫しているか？
  - 初期化 → 検証 → 処理 → 通知/ログ
- [ ] 読み順が固定されているか？
- [ ] 一貫したパターンで繰り返されているか？

## 7. テスト（Testing）

- [ ] テスト名が意図を示しているか？
- [ ] AAA パターン（Arrange / Act / Assert）になっているか？
- [ ] マジックナンバーに名前を付けているか？
  - `amount=10_000`, `is_member=True`

## AI駆動開発での追加チェック

- [ ] AIが生成したコードで、意図が不明確な箇所はないか？
- [ ] AI修正時に副作用が起きないよう、可変状態が最小化されているか？
- [ ] AI への追加指示が短く正確に書けるか？（関数が分離されているか？）

## 優先度の付け方

改善提案を出す際の優先度（3段階）:

1. **致命的（Must Fix）**: 誤解・バグ・事故につながる
   - 単位の欠如（`timeout` → `timeout_ms`）
   - ブール否定の混乱（`disable_flag` → `is_enabled`）
   - 深すぎるネスト（3段以上）

2. **推奨（Should Fix）**: 保守性・可読性を大きく改善
   - 複雑な式の分割
   - 関数の責務分離
   - コメントの「なぜ」追加

3. **好み（Nice to Have）**: 一貫性・スタイルの統一
   - 変数名の統一（`user_id` vs `userId`）
   - 段落構造の調整
   - 内包表記への変更

## 使い方

1. **レビュー対象コードを読む**
2. **このチェックリストを上から順に確認**
3. **該当する改善点を Before/After で提示**
4. **優先度を付けて提案**

## まとめの質問

最後に、この質問に答えられるか確認:

> 「このコードを2ヶ月後の自分が読んだとき、短時間で理解して安全に修正できるか？」

答えが No なら、改善の余地がある。
